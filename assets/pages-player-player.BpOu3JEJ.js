import{g as a,Y as l,h as s,j as e,o as t,c as o,w as n,a as u,n as i,m as c,t as r,q as d,i as v,k as p,l as f,F as g,$ as _,a0 as m,J as y,a1 as h,b,a2 as x,a3 as k,a4 as w}from"./index-DjBnUkLC.js";import{p as j,c as C,d as P}from"./index.C5pMNGNR.js";import{b as U}from"./uni-list-item.aUG4T5JM.js";import{C as I}from"./Comment.cl6pZOFs.js";import{_ as N}from"./plugin-vueexport-helper.BCo6x5W8.js";import"./uni-icons.BwPsJ-Ie.js";import"./uni-section.QDLSypbN.js";const S=N(a({__name:"Record",props:["bgUrl","isPaused","isplay","songName","artists","id"],emits:["changeShow"],setup(a,{emit:p}){const f=p,g=l(!1);return(l,p)=>{const _=d,m=v,y=s(e("uni-badge"),U);return t(),o(m,{class:"wh"},{default:n((()=>[u(m,{class:"play",onClick:p[0]||(p[0]=a=>f("changeShow"))},{default:n((()=>[u(m,{class:i(["playImg",{paused:!a.isPaused}])},{default:n((()=>[u(_,{mode:"heightFix",src:"/-app/assets/white_circle-BqNO7vO7.png"})])),_:1},8,["class"]),u(m,{class:"bl_circle"},{default:n((()=>[u(_,{mode:"heightFix",src:"/-app/assets/black_circle-BpXxhfCl.png"})])),_:1}),u(m,{class:i(["songPic",{paused:!a.isPaused}])},{default:n((()=>[u(_,{src:a.bgUrl},null,8,["src"])])),_:1},8,["class"]),u(m,{class:"stylus"},{default:n((()=>[u(_,{src:"/-app/assets/stylus-rkdmo8lr.png"})])),_:1}),u(m,{class:i({songPlay:a.isplay,songPause:!a.isplay})},null,8,["class"])])),_:1}),u(m,{class:"songInfo"},{default:n((()=>[u(m,{class:"infoLeft"},{default:n((()=>[u(m,{class:"songName"},{default:n((()=>[c(r(a.songName),1)])),_:1}),u(m,{class:"songArtists"},{default:n((()=>[c(r(a.artists),1)])),_:1})])),_:1}),u(m,{class:"infoRight"},{default:n((()=>[u(y,{size:"small",text:100,absolute:"rightTop",type:"default"},{default:n((()=>[u(m,{class:"infoRight_L iconfont icon-hear"})])),_:1}),u(y,{size:"small",text:100,absolute:"rightTop",type:"default"},{default:n((()=>[u(m,{class:"infoRight_R iconfont icon-xiaoxi",onClick:p[1]||(p[1]=a=>g.value=!g.value)})])),_:1})])),_:1})])),_:1}),u(I,{id:a.id,visible:g.value,"onUpdate:visible":p[2]||(p[2]=a=>g.value=a)},null,8,["id","visible"])])),_:1})}}}),[["__scopeId","data-v-64bcbe1a"]]),T=N(a({__name:"Lyric",props:["id"],emits:["changeShow"],setup(a,{emit:s}){const e=a,i=l();(async()=>{try{let a=(await j(e.id)).lrc.lyric.split("\n");i.value=a.map((a=>a.slice(1).split("]"))),console.log(i.value)}catch(a){console.log(a)}})();const d=s;return(a,l)=>{const s=v,e=_;return t(),o(s,{class:"lyric",onClick:l[0]||(l[0]=a=>d("changeShow"))},{default:n((()=>[u(e,{"scroll-y":""},{default:n((()=>[(t(!0),p(g,null,f(i.value,(a=>(t(),o(s,{class:"item",key:a[0]},{default:n((()=>[c(r(a[1]),1)])),_:2},1024)))),128))])),_:1})])),_:1})}}}),[["__scopeId","data-v-508c86f5"]]),R=N(a({__name:"Header",props:["title"],setup:a=>(l,s)=>{const e=v;return t(),o(e,{class:"header"},{default:n((()=>[u(e,{class:"left iconfont icon--xiangxiajiantou"}),u(e,{class:"center",ref:"center"},{default:n((()=>[c(r(a.title),1)])),_:1},512),u(e,{class:"right iconfont icon-fasong01"})])),_:1})}}),[["__scopeId","data-v-ad9c47a4"]]),F=N(a({__name:"player",setup(a){const s=l(),e=l(),d=l(!0),p=l(!1),f=l(!1),g=l(!1),_=l(),j=l();let U=null;const I=l(),N=l(),F=l(),q=l("00:00"),z=l(),L=l(),M=l();m((()=>{L.value=y("id"),L.value!==M.value&&(g.value=!0,p.value=!1,f.value=!1,q.value=B(0),F.value="0",null==U||U.stop(),U=null,g.value=!1)}));const B=a=>{let l=0,s=0,e=0;return l=Math.floor(a/60/60),s=Math.floor(a/60%60),e=Math.floor(a%60),0===l?D(s)+":"+D(e):D(l)+":"+D(s)+":"+D(e)},D=a=>a<10?"0"+a:a;h((()=>{(async a=>{var l,e,t,o,n;try{g.value=!0;let u=await C(a);s.value=null==(l=u.songs[0])?void 0:l.al.picUrl,_.value=(null==(e=u.songs[0])?void 0:e.name)+(0===(null==(t=u.songs[0])?void 0:t.alia.length)?"":"("+(null==(o=u.songs[0])?void 0:o.alia.map((a=>a)))+")"),j.value=null==(n=u.songs[0])?void 0:n.ar.map((a=>a.name)).join("/")}catch(u){console.log(u)}finally{g.value=!1}})(L.value||2146688401),(async a=>{try{g.value=!0;let l=await P(a);M.value=a,e.value=l.data[0].url,q.value=B(0),z.value=B(l.data[0].time/1e3)}catch(l){console.log(l)}finally{g.value=!1}})(L.value||2146688401)}));const O=()=>{p.value=!p.value,f.value=!f.value,U||(U=w(),U.src=e.value),p.value?U.play():U.pause(),A(U)},A=a=>{a.onEnded((()=>{p.value=!1,f.value=!1,q.value=B(0),F.value="0"})),a.onTimeUpdate((()=>{const l=(a.currentTime/a.duration*100).toFixed(2)+"%";F.value=l,q.value=B(a.currentTime),z.value=B(a.duration)}))},E=()=>{d.value=!d.value};return(a,l)=>{const e=v;return t(),o(e,{class:"player",ref:"player",style:b("background:url("+s.value+") no-repeat center/1000% 1000%")},{default:n((()=>[u(e,{class:"position"},{default:n((()=>[u(R,{title:d.value?"私人漫游 默认模式":_.value+"&"+j.value},null,8,["title"]),d.value?(t(),o(S,{key:0,bgUrl:s.value,isPaused:f.value,isplay:p.value,songName:_.value,artists:j.value,id:L.value,onChangeShow:E},null,8,["bgUrl","isPaused","isplay","songName","artists","id"])):(t(),o(T,{key:1,id:L.value||2146688401,onChangeShow:E},null,8,["id"])),u(e,{class:"prog",ref_key:"prog",ref:N},{default:n((()=>[u(e,{class:"progress"}),u(e,{class:"roundDot",ref_key:"roundDot",ref:I,style:b("left:"+F.value)},null,8,["style"]),u(e,{class:"proText"},{default:n((()=>[u(e,{style:{width:"50px"}},{default:n((()=>[c(r(q.value),1)])),_:1}),u(e,null,{default:n((()=>[c("极高")])),_:1}),u(e,{style:{width:"40px"}},{default:n((()=>[c(r(z.value),1)])),_:1})])),_:1})])),_:1},512),u(e,{class:"songPlay"},{default:n((()=>[u(e,{class:"iconfont icon-danquxunhuan"}),u(e,{class:"songPlay_C"},{default:n((()=>[u(e,{class:"iconfont icon-shangyishou"}),u(e,{class:i(["iconfont",{"icon-icon_play":!p.value,"icon-zanting":p.value}]),onClick:O},null,8,["class"]),u(e,{class:"iconfont icon-xiayishou"})])),_:1}),u(e,{class:"iconfont icon-bofangliebiao-copy"})])),_:1})])),_:1}),x(u(e,{class:"mask"},{default:n((()=>[c("加载中...")])),_:1},512),[[k,g.value]])])),_:1},8,["style"])}}}),[["__scopeId","data-v-e93b3357"]]);export{F as default};
